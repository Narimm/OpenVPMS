<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Letterhead" pageWidth="421" pageHeight="595" whenNoDataType="AllSectionsNoDetail" columnWidth="381" leftMargin="0" rightMargin="40" topMargin="0" bottomMargin="0" uuid="0d884615-14c1-48b1-801d-fc1e1707caca">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="39"/>
	<property name="ireport.y" value="0"/>
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<style name="Base" isDefault="true" hTextAlign="Left" vTextAlign="Middle" fontSize="7"/>
	<parameter name="IsEmail" class="java.lang.Boolean" isForPrompting="false">
		<parameterDescription><![CDATA[If true, indicates the report is being emailed, to enable different formatting]]></parameterDescription>
		<defaultValueExpression><![CDATA[Boolean.FALSE]]></defaultValueExpression>
	</parameter>
	<parameter name="pageNo" class="java.lang.Integer" isForPrompting="false">
		<parameterDescription><![CDATA[]]></parameterDescription>
		<defaultValueExpression><![CDATA[999]]></defaultValueExpression>
	</parameter>
	<field name="[party:getBillingAddress(party:getLetterheadContacts($OpenVPMS.location))]" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="[party:getEmailAddress(party:getLetterheadContacts($OpenVPMS.location))]" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="[party:getTelephone(party:getLetterheadContacts($OpenVPMS.location))]" class="java.lang.String"/>
	<field name="[party:getFaxNumber(party:getLetterheadContacts($OpenVPMS.location))]" class="java.lang.String"/>
	<field name="[party:getWebsite(party:getLetterheadContacts($OpenVPMS.location))]" class="java.lang.String"/>
	<field name="[party:getLetterheadContacts($OpenVPMS.location)/name]" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="OpenVPMS.location.letterhead.target.logoFile" class="java.lang.String"/>
	<field name="OpenVPMS.location.letterhead.target.companyID" class="java.lang.String"/>
	<field name="OpenVPMS.location.letterhead.target.plainPaper" class="java.lang.Boolean"/>
	<field name="OpenVPMS.location.letterhead.target.letterheadP1only" class="java.lang.Boolean"/>
	<variable name="isPlainPaper" class="java.lang.String"/>
	<title>
		<band height="174">
			<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
			<textField>
				<reportElement isPrintRepeatedValues="false" mode="Transparent" x="0" y="85" width="420" height="85" isRemoveLineWhenBlank="true" forecolor="#000000" uuid="618ebd66-2e03-4b8a-868b-6546cb581f8f">
					<printWhenExpression><![CDATA[(!$P{IsEmail}) && (! ($F{OpenVPMS.location.letterhead.target.plainPaper}==null?Boolean.TRUE:$F{OpenVPMS.location.letterhead.target.plainPaper})) &&
 ( ($P{pageNo}==1)?Boolean.TRUE:! ($F{OpenVPMS.location.letterhead.target.letterheadP1only}==null?Boolean.TRUE:$F{OpenVPMS.location.letterhead.target.letterheadP1only}) )]]></printWhenExpression>
				</reportElement>
			</textField>
			<frame>
				<reportElement isPrintRepeatedValues="false" x="0" y="0" width="420" height="85" isRemoveLineWhenBlank="true" uuid="46bfd1f4-931a-4dab-8629-2bc426397723">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<printWhenExpression><![CDATA[($P{pageNo}==1)&&($P{IsEmail}||($F{OpenVPMS.location.letterhead.target.plainPaper}==null?Boolean.TRUE:$F{OpenVPMS.location.letterhead.target.plainPaper}))]]></printWhenExpression>
				</reportElement>
				<image onErrorType="Blank">
					<reportElement x="10" y="0" width="198" height="71" uuid="c3554d25-7aef-45aa-be37-9ae53542e7d3">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					</reportElement>
					<imageExpression><![CDATA[$F{OpenVPMS.location.letterhead.target.logoFile}]]></imageExpression>
				</image>
				<textField>
					<reportElement x="247" y="0" width="173" height="13" uuid="09bf53e7-0c3e-4a52-927c-c0bd6d986617">
						<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					</reportElement>
					<textElement textAlignment="Left">
						<font size="9" isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{[party:getLetterheadContacts($OpenVPMS.location)/name]}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true">
					<reportElement x="247" y="13" width="173" height="20" uuid="2aefec02-5050-4445-a0b6-658b02ef5fed"/>
					<textElement textAlignment="Left">
						<font size="7" isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{[party:getBillingAddress(party:getLetterheadContacts($OpenVPMS.location))]}.trim()]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement positionType="Float" x="247" y="33" width="173" height="9" uuid="a41c49a0-d7d5-4ac9-bc7e-a4c25a7fdf03">
						<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					</reportElement>
					<textElement textAlignment="Left">
						<font size="7" isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA["Ph: "+$F{[party:getTelephone(party:getLetterheadContacts($OpenVPMS.location))]}
+(($F{[party:getFaxNumber(party:getLetterheadContacts($OpenVPMS.location))]}.length()>0)?
  ("  Fax: "+$F{[party:getFaxNumber(party:getLetterheadContacts($OpenVPMS.location))]}):"")]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement positionType="Float" x="247" y="42" width="173" height="9" uuid="b536affc-3a08-49ab-b087-684b8eee5d4f">
						<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					</reportElement>
					<textElement textAlignment="Left">
						<font size="7" isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA["E: "+$F{[party:getEmailAddress(party:getLetterheadContacts($OpenVPMS.location))]}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement positionType="Float" x="247" y="51" width="173" height="9" uuid="81182623-0bd9-4307-9d1b-c4b645d9aca3">
						<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					</reportElement>
					<textElement textAlignment="Left">
						<font size="7" isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA["W: "+$F{[party:getWebsite(party:getLetterheadContacts($OpenVPMS.location))]}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement positionType="Float" x="247" y="60" width="173" height="9" isRemoveLineWhenBlank="true" uuid="37c14047-d7e9-489e-81f1-2af6e9be27e6">
						<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					</reportElement>
					<textElement textAlignment="Left">
						<font size="7" isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{OpenVPMS.location.letterhead.target.companyID}]]></textFieldExpression>
				</textField>
			</frame>
			<staticText>
				<reportElement x="0" y="170" width="420" height="3" uuid="5493c8de-6a82-4524-8b06-c99fa0ca8b18">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
				</reportElement>
				<text><![CDATA[Static Text]]></text>
			</staticText>
		</band>
	</title>
	<summary>
		<band height="142">
			<printWhenExpression><![CDATA[Boolean.FALSE]]></printWhenExpression>
			<staticText>
				<reportElement x="0" y="0" width="420" height="141" uuid="31f66fbf-2c82-45f5-8c71-ed7ceff4ff02"/>
				<text><![CDATA[These instructions are never printed.
The Title band contains three areas: 
A) a frame at the top to contains the generated letterhead fields; 
B) a blank static field below that which represents the area occupied by the letterhead area on pre-printed stationary;
C) a 5px high blank static field that is always printed and is used a spacer to space down the other items on the document title.
 . 
For Page 1, either of A or B are printed, depending on the Plain Paper and IsEmail settings.
For pages > 1, A is never printed, and B is only printed for the not IsEmail, not Plain Paper, and not Letterhead Page 1 only - ie only when we need to space down over the preprinted letterhead. 

The height of the A & B bands is normally set to 120px.  This puts the address block in the correct place for window envelopes.
Note that if you do change the size of these, then the other items in the Title band of the system documents that use this letterhead subreport (ie the invoice, credit note, etc etc) will float up or down and this can be used to reposition the address block to suit non-standard window elements.]]></text>
			</staticText>
		</band>
	</summary>
</jasperReport>
