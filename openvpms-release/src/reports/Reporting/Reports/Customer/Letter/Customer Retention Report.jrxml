<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Customer Retention Report" pageWidth="612" pageHeight="792" whenNoDataType="AllSectionsNoDetail" columnWidth="550" leftMargin="31" rightMargin="31" topMargin="19" bottomMargin="19" isSummaryWithPageHeaderAndFooter="true" uuid="f402c6a6-4eb6-42f3-8d38-84883e7ac956">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="OpenVPMS"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<style name="Base" isDefault="true" hTextAlign="Left" vTextAlign="Middle" fontName="DejaVu Sans" fontSize="9"/>
	<parameter name="IsEmail" class="java.lang.Boolean" isForPrompting="false">
		<parameterDescription><![CDATA[If true, indicates the report is being emailed, to enable different formatting]]></parameterDescription>
		<defaultValueExpression><![CDATA[Boolean.FALSE]]></defaultValueExpression>
	</parameter>
	<parameter name="MonthsScan" class="java.lang.Integer">
		<parameterDescription><![CDATA[Period (months)]]></parameterDescription>
		<defaultValueExpression><![CDATA[12]]></defaultValueExpression>
	</parameter>
	<parameter name="DateTo" class="java.util.Date">
		<parameterDescription><![CDATA[Period 2 end date]]></parameterDescription>
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="MonthsPrior" class="java.lang.Integer">
		<parameterDescription><![CDATA[Period 1 - months prior]]></parameterDescription>
		<defaultValueExpression><![CDATA[12]]></defaultValueExpression>
	</parameter>
	<parameter name="SpentAbove" class="java.lang.Integer">
		<parameterDescription><![CDATA[Period 1 - Spent >= $]]></parameterDescription>
		<defaultValueExpression><![CDATA[500]]></defaultValueExpression>
	</parameter>
	<parameter name="PracticeLocation" class="java.lang.String">
		<parameterDescription><![CDATA[Practice Location]]></parameterDescription>
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="acType" class="java.lang.String">
		<parameterDescription><![CDATA[Account Type]]></parameterDescription>
	</parameter>
	<parameter name="showLost" class="java.lang.Boolean">
		<parameterDescription><![CDATA[Show Lost Customers]]></parameterDescription>
		<defaultValueExpression><![CDATA[Boolean.FALSE]]></defaultValueExpression>
	</parameter>
	<parameter name="showRetained" class="java.lang.Boolean">
		<parameterDescription><![CDATA[Show Retained Customers]]></parameterDescription>
		<defaultValueExpression><![CDATA[Boolean.FALSE]]></defaultValueExpression>
	</parameter>
	<parameter name="IncInactive" class="java.lang.Boolean">
		<parameterDescription><![CDATA[Include Inactive]]></parameterDescription>
		<defaultValueExpression><![CDATA[Boolean.TRUE]]></defaultValueExpression>
	</parameter>
	<parameter name="Explain" class="java.lang.Boolean">
		<parameterDescription><![CDATA[Display explanation]]></parameterDescription>
		<defaultValueExpression><![CDATA[new Boolean("false")]]></defaultValueExpression>
	</parameter>
	<queryString language="SQL">
		<![CDATA[select distinct e.name as customerName, e.entity_id as cid, e.description as contact, e.active as active,
   ifnull(loc.name,'--NONE--') as location, ifnull(l.name,'--NONE--') as accountType, ifnull(l2.name,'--NONE--') as customerType,
   date(DATE_ADD(DATE_SUB( $P{DateTo} ,INTERVAL ($P{MonthsPrior}+$P{MonthsScan}) MONTH),INTERVAL 1 DAY)) as p1dFrom,
   date(DATE_SUB(DATE_ADD($P{DateTo}, INTERVAL "23:59:59" HOUR_SECOND),INTERVAL $P{MonthsScan} MONTH)) as p1dTo,
   date(DATE_ADD(DATE_SUB($P{DateTo},INTERVAL $P{MonthsScan} MONTH),INTERVAL 1 DAY)) p2dFrom, 
(select sum(if(f.credit,-(f.total),(f.total)))as invoiceTotalInc
from acts a
join participations pc on pc.act_id = a.act_id and pc.arch_short_name = 'participation.customer'
join financial_acts f on a.act_id = f.financial_act_id
where a.arch_short_name in ('act.customerAccountChargesInvoice','act.customerAccountChargesCounter')
    and a.activity_start_time between DATE_ADD(DATE_SUB( $P{DateTo} ,INTERVAL ($P{MonthsPrior}+$P{MonthsScan}) MONTH),INTERVAL 1 DAY) and 
         DATE_SUB(DATE_ADD($P{DateTo}, INTERVAL "23:59:59" HOUR_SECOND),INTERVAL $P{MonthsScan} MONTH)
    and a.status = 'POSTED'
    and pc.entity_id = e.entity_id
) as t1Total,
(select count(*) as invoiceCount
		from acts a
		join participations pc on pc.act_id = a.act_id and pc.arch_short_name = 'participation.customer'
		where a.arch_short_name in ('act.customerAccountChargesInvoice','act.customerAccountChargesCounter')
			and a.activity_start_time between DATE_ADD(DATE_SUB($P{DateTo},INTERVAL $P{MonthsScan} MONTH),INTERVAL 1 DAY) and 
				 DATE_ADD($P{DateTo}, INTERVAL "23:59:59" HOUR_SECOND)
			and a.status = 'POSTED'
			and pc.entity_id = e.entity_id
		) as t2Count

from
entities e
left join entity_details dc on dc.entity_id = e.entity_id and dc.name = 'createdDate'
left join (entity_classifications ec, lookups l) on (ec.entity_id = e.entity_id
 and ec.lookup_id = l.lookup_id and l.arch_short_name = 'lookup.customerAccountType')
left join (entity_classifications ec2, lookups l2) on (ec2.entity_id = e.entity_id
  and ec2.lookup_id = l2.lookup_id and l2.arch_short_name = 'lookup.customerType')
left join entity_links el on el.source_id = e.entity_id and el.arch_short_name = 'entityLink.customerLocation'
left join entities loc on loc.entity_id = el.target_id
where e.arch_short_name = 'party.customerperson'
  and ((substring($P{acType},1,1)="!" and ifnull(l.name,"--NONE--")  not like concat(substring($P{acType},2),"%") ) or
    	   ( ifnull(l.name,"--NONE--") like  concat(ifnull($P{acType},""),"%") )
    	  )
  and ((substring($P{PracticeLocation},1,1)="!" and ifnull(loc.name,"--NONE--")  not like concat(substring($P{PracticeLocation},2),"%") ) or
    	   ( ifnull(loc.name,"--NONE--") like  concat(ifnull($P{PracticeLocation},""),"%") )
    	  )
  and ((e.active=true) or ($P{IncInactive}=true) )
  and (((select sum(if(f.credit,-(f.total),(f.total)))as invoiceTotalInc
from acts a
join participations pc on pc.act_id = a.act_id and pc.arch_short_name = 'participation.customer'
join financial_acts f on a.act_id = f.financial_act_id
where a.arch_short_name in ('act.customerAccountChargesInvoice','act.customerAccountChargesCounter')
    and a.activity_start_time between DATE_ADD(DATE_SUB( $P{DateTo} ,INTERVAL ($P{MonthsPrior}+$P{MonthsScan}) MONTH),INTERVAL 1 DAY) and 
         DATE_SUB(DATE_ADD($P{DateTo}, INTERVAL "23:59:59" HOUR_SECOND),INTERVAL $P{MonthsScan} MONTH)
    and a.status = 'POSTED'
    and pc.entity_id = e.entity_id
)  >=  $P{SpentAbove} )
or (date(dc.value) between DATE_ADD(DATE_SUB($P{DateTo},INTERVAL $P{MonthsScan} MONTH),INTERVAL 1 DAY)
		and DATE_ADD($P{DateTo}, INTERVAL "23:59:59" HOUR_SECOND) )
)
group by e.entity_id
order by location,accountType,t1Total desc]]>
	</queryString>
	<field name="customerName" class="java.lang.String"/>
	<field name="cid" class="java.lang.Long"/>
	<field name="contact" class="java.lang.String"/>
	<field name="active" class="java.lang.Boolean"/>
	<field name="location" class="java.lang.String"/>
	<field name="accountType" class="java.lang.String"/>
	<field name="customerType" class="java.lang.String"/>
	<field name="p1dFrom" class="java.sql.Date"/>
	<field name="p1dTo" class="java.sql.Date"/>
	<field name="p2dFrom" class="java.sql.Date"/>
	<field name="t1Total" class="java.math.BigDecimal"/>
	<field name="t2Count" class="java.lang.Long"/>
	<variable name="location1" class="java.lang.Integer" resetType="Group" resetGroup="Location" calculation="Count">
		<variableExpression><![CDATA[$F{location}]]></variableExpression>
	</variable>
	<variable name="acType1" class="java.lang.Integer" resetType="Group" resetGroup="acType" calculation="Count">
		<variableExpression><![CDATA[$F{accountType}]]></variableExpression>
	</variable>
	<variable name="countRetainedLoc" class="java.lang.Integer" resetType="Group" resetGroup="Location" calculation="Sum">
		<variableExpression><![CDATA[$F{t1Total}==null?0:($F{t2Count}.intValue()>0?1:0)]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="countRetainedType" class="java.lang.Integer" resetType="Group" resetGroup="acType" calculation="Sum">
		<variableExpression><![CDATA[$F{t1Total}==null?0:($F{t2Count}.intValue()>0?1:0)]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="countRetainedTotal" class="java.lang.Integer" calculation="Sum">
		<variableExpression><![CDATA[$F{t1Total}==null?0:($F{t2Count}.intValue()>0?1:0)]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="countLostLoc" class="java.lang.Integer" resetType="Group" resetGroup="Location" calculation="Sum">
		<variableExpression><![CDATA[$F{t1Total}==null?0:($F{t2Count}.intValue()==0?1:0)]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="countLostType" class="java.lang.Integer" resetType="Group" resetGroup="acType" calculation="Sum">
		<variableExpression><![CDATA[$F{t1Total}==null?0:($F{t2Count}.intValue()==0?1:0)]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="countLostTotal" class="java.lang.Integer" calculation="Sum">
		<variableExpression><![CDATA[$F{t1Total}==null?0:($F{t2Count}.intValue()==0?1:0)]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="countLoc" class="java.lang.Integer" resetType="Group" resetGroup="Location" calculation="Sum">
		<variableExpression><![CDATA[$F{t1Total}==null?0:1]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="countType" class="java.lang.Integer" resetType="Group" resetGroup="acType" calculation="Sum">
		<variableExpression><![CDATA[$F{t1Total}==null?0:1]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="countTotal" class="java.lang.Integer" calculation="Sum">
		<variableExpression><![CDATA[$F{t1Total}==null?0:1]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="countNewLoc" class="java.lang.Integer" resetType="Group" resetGroup="Location" calculation="Sum">
		<variableExpression><![CDATA[$F{t1Total}==null?1:0]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="countNewType" class="java.lang.Integer" resetType="Group" resetGroup="acType" calculation="Sum">
		<variableExpression><![CDATA[$F{t1Total}==null?1:0]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<variable name="countNewTotal" class="java.lang.Integer" calculation="Sum">
		<variableExpression><![CDATA[$F{t1Total}==null?1:0]]></variableExpression>
		<initialValueExpression><![CDATA[0]]></initialValueExpression>
	</variable>
	<group name="Dummy">
		<groupFooter>
			<band height="16">
				<textField>
					<reportElement x="0" y="0" width="360" height="16" uuid="ccf5fde5-9da6-4fa2-90b5-a03c728bfd21">
						<property name="local_mesure_unitheight" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
					</reportElement>
					<textElement>
						<font size="11" isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA["Overall Counts"]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Band">
					<reportElement x="361" y="0" width="47" height="16" uuid="edbc8cd1-6177-4465-9074-a23dd6b65acb"/>
					<textElement textAlignment="Right">
						<font isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{countTotal}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Band" pattern="##0.0">
					<reportElement x="408" y="0" width="48" height="16" uuid="6aa65059-0e36-4d66-8af0-7494d9a71e05">
						<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
						<printWhenExpression><![CDATA[$V{countTotal}>0]]></printWhenExpression>
					</reportElement>
					<textElement textAlignment="Right">
						<font isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{countLostTotal}.floatValue()*100.0/$V{countTotal}.floatValue()]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Band" pattern="##0.0">
					<reportElement x="456" y="0" width="47" height="16" uuid="5ce74905-5660-4bde-acef-4675c62d940f">
						<printWhenExpression><![CDATA[$V{countTotal}>0]]></printWhenExpression>
					</reportElement>
					<textElement textAlignment="Right">
						<font isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{countRetainedTotal}.floatValue()*100.0/$V{countTotal}.floatValue()]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Band" pattern="##0.0">
					<reportElement x="503" y="0" width="47" height="16" uuid="a0c2a2af-04fd-42ae-b45c-5e7469834ab9">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<printWhenExpression><![CDATA[$V{countTotal}>0]]></printWhenExpression>
					</reportElement>
					<textElement textAlignment="Right">
						<font isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{countNewTotal}.floatValue()*100.0/$V{countTotal}.floatValue()]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="Location">
		<groupExpression><![CDATA[$F{location}]]></groupExpression>
		<groupHeader>
			<band/>
		</groupHeader>
		<groupFooter>
			<band height="16">
				<textField>
					<reportElement x="0" y="0" width="360" height="16" uuid="7b85967e-f59c-4263-9c27-c46995e60aa3">
						<property name="local_mesure_unitheight" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
					</reportElement>
					<textElement>
						<font size="11" isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{location}+" Counts"]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Band">
					<reportElement x="361" y="0" width="47" height="16" uuid="c905fa89-d078-40f8-99e1-97d5c1d2faf6">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					</reportElement>
					<textElement textAlignment="Right">
						<font isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{countLoc}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Band" pattern="##0.0">
					<reportElement x="408" y="0" width="48" height="16" uuid="1c2fd5b2-2272-45fd-821f-d3ccca570983">
						<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
						<printWhenExpression><![CDATA[$V{countLoc}>0]]></printWhenExpression>
					</reportElement>
					<textElement textAlignment="Right">
						<font isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{countLostLoc}*100.0/$V{countLoc}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Band" pattern="##0.0">
					<reportElement x="456" y="0" width="47" height="16" uuid="e79358dc-e4a6-43e7-96e9-9b534b994525">
						<printWhenExpression><![CDATA[$V{countLoc}>0]]></printWhenExpression>
					</reportElement>
					<textElement textAlignment="Right">
						<font isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{countRetainedLoc}*100.0/$V{countLoc}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Band" pattern="##0.0">
					<reportElement x="503" y="0" width="47" height="16" uuid="d70cf1d2-6385-44e6-9ee1-e8fb55553015">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<printWhenExpression><![CDATA[$V{countLoc}>0]]></printWhenExpression>
					</reportElement>
					<textElement textAlignment="Right">
						<font isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{countNewLoc}*100.0/$V{countLoc}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="acType" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{accountType}]]></groupExpression>
		<groupHeader>
			<band height="21">
				<printWhenExpression><![CDATA[$P{showLost}||$P{showRetained}]]></printWhenExpression>
				<textField>
					<reportElement x="0" y="0" width="360" height="16" uuid="2fce9345-fff8-4df8-adc3-55a5471a65c6">
						<property name="local_mesure_unitheight" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
					</reportElement>
					<textElement>
						<font isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{location}+" / "+$F{accountType}+(($V{acType1}==null)?"":" (cont)")]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="16">
				<textField>
					<reportElement x="0" y="0" width="360" height="16" uuid="f2d278f4-555d-43ab-a329-0c572730cf64">
						<property name="local_mesure_unitheight" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
					</reportElement>
					<textElement>
						<font size="9" isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{location}+" / "+$F{accountType}+" Counts"]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Band">
					<reportElement x="361" y="0" width="47" height="16" uuid="3003bc30-0817-47bb-a770-f1f36c05fafe">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					</reportElement>
					<textElement textAlignment="Right">
						<font isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{countType}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Band" pattern="##0.0">
					<reportElement x="408" y="0" width="48" height="16" uuid="7691c898-b727-4e10-be1b-50e06664ee81">
						<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
						<printWhenExpression><![CDATA[$V{countType}>0]]></printWhenExpression>
					</reportElement>
					<textElement textAlignment="Right">
						<font isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{countLostType}*100.0/$V{countType}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Band" pattern="##0.0">
					<reportElement x="456" y="0" width="47" height="16" uuid="69be49b3-e49e-45bc-813b-d72cc25f1724">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<printWhenExpression><![CDATA[$V{countType}>0]]></printWhenExpression>
					</reportElement>
					<textElement textAlignment="Right">
						<font isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{countRetainedType}*100.0/$V{countType}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Band" pattern="##0.0">
					<reportElement x="503" y="0" width="47" height="16" uuid="70483b34-0e33-4081-ace5-a8fb5ff3053b">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<printWhenExpression><![CDATA[$V{countType}>0]]></printWhenExpression>
					</reportElement>
					<textElement textAlignment="Right">
						<font isBold="true"/>
						<paragraph lineSpacing="Single"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{countNewType}*100.0/$V{countType}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="93" splitType="Stretch">
			<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
			<staticText>
				<reportElement key="staticText-1" x="123" y="0" width="304" height="23" uuid="3e6c54a8-8f2c-45fc-ac29-e8b0943a492e"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center">
					<font size="16" isBold="true" isUnderline="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Customer Retention Report]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-9" x="189" y="40" width="88" height="15" uuid="1524bbb4-a177-4f08-ad6d-55b108954756"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Account Type: ]]></text>
			</staticText>
			<textField isBlankWhenNull="false">
				<reportElement key="textField-1" x="411" y="20" width="82" height="17" uuid="d75b8b89-900e-4270-b9c9-0438e4ca024f"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["Page " + $V{PAGE_NUMBER} + " of "]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report" isBlankWhenNull="false">
				<reportElement key="textField-2" x="494" y="20" width="55" height="17" uuid="bd59144b-0d1c-46a0-a2d2-59561e8ebd63"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER} + ""]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="279" y="40" width="76" height="15" uuid="eded55e4-0841-4fe4-b266-fe4ca9591076">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[($P{acType}==null)?"%":$P{acType}+"%"]]></textFieldExpression>
			</textField>
			<textField pattern="">
				<reportElement x="447" y="0" width="103" height="10" uuid="d8d4df95-edc1-46b6-b025-c5130b7746ed"/>
				<textElement textAlignment="Right">
					<font fontName="SansSerif" size="7"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[DateFormat.getDateTimeInstance(DateFormat.SHORT,DateFormat.SHORT, $P{REPORT_LOCALE}).format(new Date())]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-9" x="1" y="40" width="102" height="15" uuid="3ac9749a-47f4-4c78-af3d-c8eea4eeece5"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Practice Location: ]]></text>
			</staticText>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="105" y="40" width="64" height="15" uuid="515fadd1-8864-4619-aa7a-537ed6c6cc5a">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[($P{PracticeLocation}==null)?"%":$P{PracticeLocation}+"%"]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-9" x="167" y="56" width="110" height="16" uuid="ebde4b0a-abba-4403-91d2-e2d89c873597">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Period 2 end date: ]]></text>
			</staticText>
			<textField pattern="MM/dd/yyyy">
				<reportElement x="281" y="56" width="67" height="16" uuid="c8c38391-a25e-404f-bc9f-c0eb4d441fcb">
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[DateFormat.getDateInstance(DateFormat.SHORT, $P{REPORT_LOCALE}).format($P{DateTo})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-9" x="1" y="56" width="102" height="16" uuid="86ce720b-68cf-48bb-b75f-104ffc66730b">
					<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Period (months): ]]></text>
			</staticText>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="105" y="56" width="34" height="16" uuid="7640963c-0709-45d2-bde1-597cd560a9f4">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{MonthsScan}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-9" x="350" y="56" width="130" height="16" uuid="4e9e1ca3-3415-4027-94ab-29458e607c96"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Period 1 - months prior: ]]></text>
			</staticText>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="482" y="56" width="28" height="16" uuid="0ca9d693-e61d-4744-85fa-4ffef77cf5a3">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{MonthsPrior}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-9" x="374" y="40" width="106" height="15" uuid="bd0f6a1c-e947-4024-9b06-167dc1a1d32c"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Spent >= in P1: ]]></text>
			</staticText>
			<textField pattern="¤#,##0" isBlankWhenNull="false">
				<reportElement key="textField" x="482" y="40" width="67" height="15" uuid="a6cba270-fd27-436c-9e0d-3f3150719aa4">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{SpentAbove}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-9" x="0" y="72" width="103" height="16" uuid="f70e47a8-903b-4bea-9773-b600528dccf0"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Incl Inactive: ]]></text>
			</staticText>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="105" y="72" width="85" height="16" uuid="b6e49966-fb8e-4373-bd22-6869538a4377">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{IncInactive}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band height="17" splitType="Stretch">
			<textField isBlankWhenNull="false">
				<reportElement key="textField-1" x="412" y="0" width="82" height="17" isRemoveLineWhenBlank="true" uuid="e25f7194-f03f-48c3-b2ef-6b8ccca36190">
					<printWhenExpression><![CDATA[$V{PAGE_NUMBER}>1]]></printWhenExpression>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["Page " + $V{PAGE_NUMBER} + " of "]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report" isBlankWhenNull="false">
				<reportElement key="textField-2" x="495" y="0" width="55" height="17" isRemoveLineWhenBlank="true" uuid="8f1aa8e5-9da3-424e-8fdf-bae70fdcf941">
					<printWhenExpression><![CDATA[$V{PAGE_NUMBER}>1]]></printWhenExpression>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER} + ""]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="59" splitType="Stretch">
			<staticText>
				<reportElement key="staticText-12" x="504" y="40" width="45" height="16" isRemoveLineWhenBlank="true" uuid="e94edaa3-2ec3-46f4-bbc1-9f14195fb97b">
					<printWhenExpression><![CDATA[$P{showLost}||$P{showRetained}]]></printWhenExpression>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right">
					<font isBold="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Spent]]></text>
			</staticText>
			<line>
				<reportElement key="line-1" x="0" y="57" width="550" height="1" uuid="abb63689-3b7d-49d6-84b3-2a655899c846">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
			</line>
			<staticText>
				<reportElement key="staticText-15" x="0" y="40" width="164" height="16" isRemoveLineWhenBlank="true" uuid="66db8925-e1a7-4ab2-ada8-17706ecc4916">
					<printWhenExpression><![CDATA[$P{showLost}||$P{showRetained}]]></printWhenExpression>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font isBold="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Customer]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-16" x="165" y="40" width="318" height="16" isRemoveLineWhenBlank="true" uuid="9efde03a-a9ed-4e38-b81f-f413c4be1456">
					<printWhenExpression><![CDATA[$P{showLost}||$P{showRetained}]]></printWhenExpression>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left">
					<font isBold="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Contact]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-15" x="0" y="24" width="164" height="16" uuid="6311215d-c824-43c6-9207-c76e890e339e"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font isBold="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Location/Account Type]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-15" x="350" y="24" width="57" height="16" uuid="f2e62035-0410-4f98-b282-43c351acbaa6">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right">
					<font isBold="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[P1 Count]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-15" x="413" y="24" width="42" height="16" uuid="94b21c71-418f-4c57-87cc-d3138e7f5300">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right">
					<font isBold="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[% Lost]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-15" x="464" y="24" width="39" height="16" uuid="3e7753fb-b895-442b-b117-418ebab4cc19"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right">
					<font isBold="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[% Ret.]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-15" x="510" y="24" width="39" height="16" uuid="9df995d0-a5f7-4fad-9c73-387d985d7f74"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right">
					<font isBold="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[% New]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-9" x="0" y="0" width="103" height="24" uuid="c7b525ea-59a3-46d2-b6a2-e2f74467f417">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<printWhenExpression><![CDATA[$V{PAGE_NUMBER}==1]]></printWhenExpression>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font isBold="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Period 1 is from: ]]></text>
			</staticText>
			<textField pattern="MM/dd/yyyy">
				<reportElement x="103" y="0" width="67" height="24" uuid="d86ee9d5-089b-419e-b742-8408cc1cb20b">
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
					<printWhenExpression><![CDATA[$V{PAGE_NUMBER}==1]]></printWhenExpression>
				</reportElement>
				<textElement verticalAlignment="Top">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[DateFormat.getDateInstance(DateFormat.SHORT, $P{REPORT_LOCALE}).format($F{p1dFrom})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-9" x="170" y="0" width="32" height="24" uuid="d93fabba-e7f7-4b0c-a0e6-b12fb69a20b2">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<printWhenExpression><![CDATA[$V{PAGE_NUMBER}==1]]></printWhenExpression>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font isBold="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[to: ]]></text>
			</staticText>
			<textField pattern="MM/dd/yyyy">
				<reportElement x="202" y="0" width="66" height="24" uuid="3c104572-6295-4385-aa33-048ac207dadb">
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
					<printWhenExpression><![CDATA[$V{PAGE_NUMBER}==1]]></printWhenExpression>
				</reportElement>
				<textElement verticalAlignment="Top">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[DateFormat.getDateInstance(DateFormat.SHORT, $P{REPORT_LOCALE}).format($F{p1dTo})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-9" x="268" y="0" width="111" height="24" uuid="d4f193d7-103a-4270-8807-acee78cb0472">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<printWhenExpression><![CDATA[$V{PAGE_NUMBER}==1]]></printWhenExpression>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font isBold="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Period 2 is from: ]]></text>
			</staticText>
			<textField pattern="MM/dd/yyyy">
				<reportElement x="379" y="0" width="66" height="24" uuid="f362ae8f-096c-4579-aaab-cb2bc2df960d">
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
					<printWhenExpression><![CDATA[$V{PAGE_NUMBER}==1]]></printWhenExpression>
				</reportElement>
				<textElement verticalAlignment="Top">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[DateFormat.getDateInstance(DateFormat.SHORT, $P{REPORT_LOCALE}).format($F{p2dFrom})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-9" x="445" y="0" width="32" height="24" uuid="7cc1d651-3bf9-4cc1-90fc-41339f7f6451">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<printWhenExpression><![CDATA[$V{PAGE_NUMBER}==1]]></printWhenExpression>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font isBold="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[to: ]]></text>
			</staticText>
			<textField pattern="MM/dd/yyyy">
				<reportElement x="477" y="0" width="67" height="24" uuid="de7b99ce-90ac-4c9c-bad1-65618b08b3fb">
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
					<printWhenExpression><![CDATA[$V{PAGE_NUMBER}==1]]></printWhenExpression>
				</reportElement>
				<textElement verticalAlignment="Top">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[DateFormat.getDateInstance(DateFormat.SHORT, $P{REPORT_LOCALE}).format($P{DateTo})]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<detail>
		<band height="14" splitType="Prevent">
			<printWhenExpression><![CDATA[(($P{showLost}&&($F{t2Count}.intValue()==0))||($P{showRetained}&&($F{t2Count}.intValue()>0)))&&($F{t1Total}!=null)]]></printWhenExpression>
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement key="textField" isPrintRepeatedValues="false" x="14" y="0" width="157" height="13" uuid="380e6bdb-da5f-4f74-b587-d4a6ac72aad0">
					<property name="local_mesure_unity" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{customerName}+" ("+$F{cid}.toString()+")"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="textField" isPrintRepeatedValues="false" mode="Opaque" x="177" y="0" width="314" height="13" uuid="d455c8eb-7687-44cd-aa3f-9645c9bf45af">
					<property name="local_mesure_unity" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{contact}.replaceAll("\n"," ")]]></textFieldExpression>
			</textField>
			<textField pattern="¤#,##0;¤-#,##0" isBlankWhenNull="false">
				<reportElement key="textField" x="493" y="0" width="56" height="13" uuid="b6d4028c-03dd-46cd-8108-291f161000db">
					<property name="local_mesure_unity" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{t1Total}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement key="textField" isPrintRepeatedValues="false" x="0" y="0" width="14" height="13" uuid="56928c89-7459-41dc-8c93-c12b6e302980">
					<printWhenExpression><![CDATA[$F{t2Count}.intValue()==0]]></printWhenExpression>
				</reportElement>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[($F{active}?" ":"#")+($F{t2Count}.intValue()==0?"!":"")]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<summary>
		<band height="339" splitType="Stretch">
			<printWhenExpression><![CDATA[($V{REPORT_COUNT}==0)||$P{Explain}]]></printWhenExpression>
			<staticText>
				<reportElement x="107" y="6" width="336" height="18" isRemoveLineWhenBlank="true" uuid="8fe3334b-0f49-4cad-9bd6-91d3f90ecc88">
					<printWhenExpression><![CDATA[$V{REPORT_COUNT}==0]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Center">
					<font size="13" isBold="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[No Data Found - Check Parameters]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="26" width="550" height="313" isRemoveLineWhenBlank="true" uuid="4b25e5c6-6e79-4be5-844a-60769ffa0c66">
					<printWhenExpression><![CDATA[$P{Explain}]]></printWhenExpression>
				</reportElement>
				<textElement verticalAlignment="Top">
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[This report counts retained and lost customers by comparing their activity in two periods P1 and P2. You specify the duration of both periods via the 'Period (months)' parameter (N); the end date of P2 via the 'Period 2 end date' parameter (D2); and the 'Period 1 - months prior' parameter (M).
Hence period P2 is the N months prior to D2, and period P1 is the N months prior to the date (D2 minus M months). 
'Activity' means having invoices (or counter sales).
Only customers who spent more than the 'Spent Above' amount in the earlier P1 period are examined.
Unless you uncheck the 'Include Inactivated' option, customers who are now de-activated will be included.
The selection fields entered have % added so that leaving them blank will find all, and entering say account type 'n' will include all customers with account types starting 'n', and entering practice location '%branch' will find all customers with locations containing 'branch'. The selection is case-insensitive.
Null practice locations and account types will be shown as '--NONE--' and using the selection '-' will find these; ie setting the account type selection to '-' will find customers with no account type. 
You can also use a selection string starting ! to use a 'not like' selection - so account type '!c' will find customers with account types not starting with c, and  setting it to '!-' will find all customers with a non-null account type.
If you check either of the 'Show Lost Customers' or 'Show Retained Customers' options then the customers are grouped by Practice Location/Account Type and shown in descending order of their amount spent in the earlier P1 period.
The left column will have a # for any customers now Inactive, and a ! for any lost customers.
The P1 Count column shows the number of customers who spend more than the specified amount in the earlier P1 period.
The % Lost column shows the percentage of these who spent nothing in the P2 period.
The % Ret. column shows the percentage of these who spent something in the P2 period and were thus retained.
The %New column shows the number of new customers in the P2 period (as defined by them having a Date Created within the P2 period) as a percentage of the Count of customers in the P1 period.
If % New is greater than % Lost, then your business is gaining customers.]]></text>
			</staticText>
		</band>
	</summary>
</jasperReport>
