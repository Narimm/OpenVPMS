<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE page-specification
      PUBLIC "-//Apache Software Foundation//Tapestry Specification 4.0//EN"
      "http://jakarta.apache.org/tapestry/dtd/Tapestry_4_0.dtd">
<!-- generated by Spindle, http://spindle.sourceforge.net -->

<page-specification class="org.openvpms.component.presentation.tapestry.page.EditPage">
    
    <!-- The Error components for Delegate errors -->
    <property name="currentFieldTracking" />
    <property name="index" />

    <component id="errors" type="For" >
        <binding name="source" value="delegate.fieldTracking" />
        <binding name="value" value="currentFieldTracking" />
    </component>
    <component id="error" type="Delegator" >
        <binding name="delegate" value="currentFieldTracking.errorRenderer" />
    </component>
    <component id="isInError" type="If" >
        <binding name="condition" value="currentFieldTracking.inError" />
        <binding name="element" value="literal:li" />
    </component>   

    <!-- The Submit components for the Main details form -->
    <component id="archetypeCombo" type="PropertySelection">
        <binding name="displayName" value="descriptor.displayName"/>
        <binding name="model" value="getArchetypeNamesModel(descriptor)"/>
        <binding name="value" value="archetypeName" />
    </component>               

    <component id="saveButton" type="Submit">
        <binding name="action" value="listener:onMainApply"/>
    </component>
    <component id="saveAndReturnButton" type="Submit">
        <binding name="action" value="listener:onMainOK"/>
    </component>
     <component id="removeButton" type="Submit">
        <binding name="action" value="listener:onMainRemove"/>
    </component>
     <component id="cancelButton" type="Submit">
        <binding name="action" value="listener:onMainCancel"/>
		<binding name="onclick">
		literal: javascript:this.form.events.cancel();
		</binding>
    </component>
 
    <!-- The Node Form components -->
   	<component id="nodeTable" type="openvpms:NodeTable">
      	<binding name="archetypeDescriptor" value="archetypeDescriptor"/>
        <binding name="model" value="model"/>
        <binding name="nodeNames" value="nodeNames"/>
    </component>

    <component id="nodeForm" type="Form">
        <binding name="delegate" value="bean:delegate" />
        <binding name="listener" value="listener:onMainSubmit" />
        <binding name="refresh" value="listener:onMainRefresh" />
		<binding name="cancel" value="listener:onMainCancel"/>
		<binding name="direct" value="true"/>
    </component>   

    <!-- The Collection details components -->
    
    <component id="collectionEditor" type="openvpms:CollectionEditor">
        <binding name="collection" value="jxpath:pathToObject(model, descriptor/path)"/>
        <binding name="descriptor" value="descriptor" />
    </component>    
</page-specification>
